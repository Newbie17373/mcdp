<!-- AIzaSyD0zrKhAYAFKvmxCJepXCcsM-C81Q3zRyI -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MCDP v 0.1</title>
    <link rel="stylesheet" href="./assets/css/pages/index.css" />
  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <div class="header__inside container">
          <div class="header__intro">
            <div class="header__logo">
              <img
                src="./assets/img/logo.svg"
                alt=""
                class="header__logo-item"
              />
            </div>
            <h1 class="header__title">Music Chill Dance Player</h1>
          </div>
          <nav class="header__nav">
            <ul class="header__list">
              <li class="header__list-item">
                <a href="./index.html" class="header__list-link">Main</a>
              </li>
              <li class="header__list-item">
                <a href="#" class="header__list-link">About</a>
              </li>
              <li class="header__list-item">
                <a href="#" class="header__list-link">Donate</a>
              </li>
              <li class="header__list-item">
                <a href="#" class="header__list-link">Socials</a>
              </li>
            </ul>
          </nav>
          <div class="header__personal-area">
            <button class="header__button">Sign in/Sign up</button>
          </div>
        </div>
      </header>
      <div class="main">
        <div class="main__inside">
          <div class="youtube">
            <div class="youtube__inside container">
              <!-- youtube music integration -->
              <h2 class="youtube__title">YouTube Music Integration</h2>

              <label for="searchInput">Search:</label>
              <input
                type="text"
                id="searchInput"
                placeholder="Enter your search query"
              />
              <ul class="youtube__menu">
                <li class="youtube-menu-item">
                  <button
                    class="youtube__button header__button"
                    onclick="searchYouTubeMusic()"
                  >
                    Search
                  </button>
                </li>
                <li class="youtube-menu-item">
                  <button
                    class="youtube__button header__button"
                    onclick="clearResults()"
                  >
                    Clear
                  </button>
                </li>
              </ul>

              <ul id="searchResults"></ul>

              <!-- Add the player container -->
              <div id="player"></div>

              <script>
                // Replace 'YOUR_API_KEY' with your actual YouTube Data API key
                const apiKey = "AIzaSyD0zrKhAYAFKvmxCJepXCcsM-C81Q3zRyI";
                const apiUrl = "https://www.googleapis.com/youtube/v3/search";
                const playerContainer = document.getElementById("player");

                function searchYouTubeMusic() {
                  const searchQuery =
                    document.getElementById("searchInput").value;
                  const requestUrl = `${apiUrl}?q=${encodeURIComponent(
                    searchQuery
                  )}&part=snippet&key=${apiKey}&type=video,playlist&maxResults=10`;

                  fetch(requestUrl)
                    .then((response) => response.json())
                    .then((data) => displaySearchResults(data.items))
                    .catch((error) => console.error("Error:", error));
                }

                const searchResultsContainer =
                  document.getElementById("searchResults");

                function clearResults() {
                  searchResultsContainer.innerHTML = "";
                }

                function displaySearchResults(results) {
                  clearResults();

                  results.forEach((result) => {
                    const videoId = result.id.videoId;
                    const title = result.snippet.title;
                    const thumbnailUrl = result.snippet.thumbnails.default.url;

                    const listItem = document.createElement("li");
                    listItem.innerHTML = `
                    <div class="youtube__image">
                      <img class="youtube__image-item" src="${thumbnailUrl}" alt="${title}">
                      </div>
<p class="youtube__title">${title}</p>
<button class="youtube__button header__button" onclick="playVideo('${videoId}')">Play</button>
`;

                    searchResultsContainer.appendChild(listItem);
                  });
                }

                function playVideo(videoId) {
                  const playerHtml = `
<iframe id="youtubePlayer" width="560" height="315" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>
`;

                  playerContainer.innerHTML = playerHtml;

                  // Добавим событие 'onload' для iframe, чтобы начать воспроизведение после полной загрузки
                  const youtubePlayer =
                    document.getElementById("youtubePlayer");
                  youtubePlayer.onload = function () {
                    youtubePlayer.contentWindow.postMessage(
                      '{"event":"command","func":"playVideo","args":""}',
                      "*"
                    );
                  };
                }
              </script>
              <!-- youtube music integration end -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
